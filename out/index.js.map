{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { dirname } from 'path';\nimport sassCompiler from 'sass';\nimport { style as filter } from 'svelte-preprocess-filter';\n\nexport async function preprocessSass(\n  sassOptions = {},\n  filterOptions = {},\n  { filename, content, attributes }\n) {\n  // Detect if styles should be processed and in we should use sass (indented) syntax.\n  let indentedSyntax;\n  let processStyles;\n\n  if (filterOptions.name === undefined) {\n    indentedSyntax = filter({ name: 'sass', ...filterOptions }, { attributes });\n    processStyles = indentedSyntax || filter({ name: 'scss', ...filterOptions }, { attributes });\n  } else {\n    indentedSyntax = filterOptions.name === 'sass';\n    processStyles = filter(filterOptions, { attributes });\n  }\n\n  if (!processStyles) return null;\n\n  const { css, map, stats } = await new Promise((resolve, reject) =>\n    sassCompiler.render(\n      {\n        file: filename,\n        data: content,\n        includePaths: [dirname(filename)],\n        indentedSyntax,\n        ...sassOptions,\n      },\n      (err, result) => {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(result);\n        }\n      }\n    )\n  );\n\n  return { code: css.toString(), map, dependencies: stats.includedFiles };\n}\n\nexport function sass(sassOptions, filterOptions) {\n  return preprocessSass.bind(null, sassOptions, filterOptions);\n}\n"],"names":["preprocessSass","sassOptions","filterOptions","filename","content","attributes","indentedSyntax","processStyles","name","undefined","filter","css","map","stats","Promise","resolve","reject","sassCompiler","render","file","data","includePaths","dirname","err","result","code","toString","dependencies","includedFiles","sass","bind"],"mappings":";;;;;;;;;;;;AAIO,eAAeA,cAAf,CACLC,WAAW,GAAG,EADT,EAELC,aAAa,GAAG,EAFX,EAGL;AAAEC,EAAAA,QAAF;AAAYC,EAAAA,OAAZ;AAAqBC,EAAAA;AAArB,CAHK,EAIL;AACA;AACA,MAAIC,cAAJ;AACA,MAAIC,aAAJ;;AAEA,MAAIL,aAAa,CAACM,IAAd,KAAuBC,SAA3B,EAAsC;AACpCH,IAAAA,cAAc,GAAGI,4BAAM,CAAC;AAAEF,MAAAA,IAAI,EAAE,MAAR;AAAgB,SAAGN;AAAnB,KAAD,EAAqC;AAAEG,MAAAA;AAAF,KAArC,CAAvB;AACAE,IAAAA,aAAa,GAAGD,cAAc,IAAII,4BAAM,CAAC;AAAEF,MAAAA,IAAI,EAAE,MAAR;AAAgB,SAAGN;AAAnB,KAAD,EAAqC;AAAEG,MAAAA;AAAF,KAArC,CAAxC;AACD,GAHD,MAGO;AACLC,IAAAA,cAAc,GAAGJ,aAAa,CAACM,IAAd,KAAuB,MAAxC;AACAD,IAAAA,aAAa,GAAGG,4BAAM,CAACR,aAAD,EAAgB;AAAEG,MAAAA;AAAF,KAAhB,CAAtB;AACD;;AAED,MAAI,CAACE,aAAL,EAAoB,OAAO,IAAP;AAEpB,QAAM;AAAEI,IAAAA,GAAF;AAAOC,IAAAA,GAAP;AAAYC,IAAAA;AAAZ,MAAsB,MAAM,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAC5CC,gCAAY,CAACC,MAAb,CACE;AACEC,IAAAA,IAAI,EAAEhB,QADR;AAEEiB,IAAAA,IAAI,EAAEhB,OAFR;AAGEiB,IAAAA,YAAY,EAAE,CAACC,YAAO,CAACnB,QAAD,CAAR,CAHhB;AAIEG,IAAAA,cAJF;AAKE,OAAGL;AALL,GADF,EAQE,CAACsB,GAAD,EAAMC,MAAN,KAAiB;AACf,QAAID,GAAJ,EAAS;AACPP,MAAAA,MAAM,CAACO,GAAD,CAAN;AACD,KAFD,MAEO;AACLR,MAAAA,OAAO,CAACS,MAAD,CAAP;AACD;AACF,GAdH,CADgC,CAAlC;AAmBA,SAAO;AAAEC,IAAAA,IAAI,EAAEd,GAAG,CAACe,QAAJ,EAAR;AAAwBd,IAAAA,GAAxB;AAA6Be,IAAAA,YAAY,EAAEd,KAAK,CAACe;AAAjD,GAAP;AACD;AAEM,SAASC,IAAT,CAAc5B,WAAd,EAA2BC,aAA3B,EAA0C;AAC/C,SAAOF,cAAc,CAAC8B,IAAf,CAAoB,IAApB,EAA0B7B,WAA1B,EAAuCC,aAAvC,CAAP;AACD;;;;;"}